package lab.cadl.cadts.topo.render.model.exploit;

import lab.cadl.cadts.topo.render.model.Node;
import lab.cadl.cadts.topo.render.model.decorators.BugDecorator;

import java.util.ArrayList;
import java.util.List;

public class ExploitAction {
    private Vulnerability vulnerability;
    private Node node;
    private List<ExploitAction> nextActions = new ArrayList<>();

    public ExploitAction(Vulnerability vulnerability, Node node) {
        this.vulnerability = vulnerability;
        this.node = node;
    }

    void addNextAction(ExploitAction action) {
        nextActions.add(action);
        BugDecorator bugDecorator = node.checkBug(vulnerability.getName());
        bugDecorator.addExpectedNext(action.node.checkBug(action.vulnerability.getName()));
    }

    public List<ExploitAction> getNextActions() {
        return nextActions;
    }

    public Vulnerability getVulnerability() {
        return vulnerability;
    }

    public Node getNode() {
        return node;
    }
}
